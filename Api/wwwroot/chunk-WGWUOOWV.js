import{$ as R,Aa as De,Ba as Ie,Ca as Se,Da as we,Ea as ve,Fa as ye,Ga as Me,Ha as Ee,I as re,Ia as Ue,J as D,Ja as Ae,Ka as P,L as ne,W as ae,X as oe,Y as se,Z as ce,_ as de,aa as le,b as te,ba as me,ca as v,da as pe,ea as ue,fa as ge,ga as fe,h as ie,ha as A,ia as B,la as F,ma as he,na as be,sa as _e,ta as Ce,va as Re,wa as V,xa as k,ya as xe,za as Te}from"./chunk-YOPUJXDV.js";import{Ba as x,Db as d,Fa as j,Ib as y,Jb as M,Ka as Q,Lb as E,Mb as U,Nb as a,Ob as r,Oc as Z,Pb as u,Qb as I,Rb as S,Sc as ee,Tb as C,Vb as g,Wb as p,aa as $,bb as s,cc as q,dc as Y,ec as z,fc as o,ga as l,gc as G,hc as w,jb as L,jc as W,ma as b,mc as J,na as _,nc as K,ob as T,tb as f,uc as X}from"./chunk-HDYI5GJV.js";var h=class i{baseUrl=ie.baseUrl;http=l(te);getTrainingRecordExercisesBasicDataByUserId(e){return this.http.get(this.baseUrl+"/trainingRecord/user/"+e+"/exercises")}getTrainingRecordsByUserIdAndExerciseId(e,t){return this.http.get(this.baseUrl+"/trainingRecord/user/"+e+"/exercise/"+t)}getExercisesBasicData(){return this.http.get(this.baseUrl+"/exercise/basicData")}createTrainingRecord(e){return this.http.post(this.baseUrl+"/trainingRecord",e)}deleteRecordById(e){return this.http.delete(this.baseUrl+"/trainingRecord/"+e)}static \u0275fac=function(t){return new(t||i)};static \u0275prov=$({token:i,factory:i.\u0275fac,providedIn:"root"})};var Ve=()=>[5,10,15,20];function ke(i,e){if(i&1&&u(0,"p-chart",3),i&2){let t=p();d("data",t.data)("options",t.options)}}function Pe(i,e){i&1&&(a(0,"th",18),o(1," Weight "),r())}function Ne(i,e){if(i&1&&(a(0,"td",19),o(1),r()),i&2){let t=e.$implicit;s(),w(" ",t.weightLifted," ")}}function Oe(i,e){i&1&&(a(0,"th",18),o(1," Repetitions "),r())}function Le(i,e){if(i&1&&(a(0,"td",19),o(1),r()),i&2){let t=e.$implicit;s(),w(" ",t.repetitionsMade," ")}}function qe(i,e){i&1&&(a(0,"th",18),o(1," Date "),r())}function He(i,e){if(i&1&&(a(0,"td",19),o(1),J(2,"date"),r()),i&2){let t=e.$implicit;s(),w(" ",K(2,1,t.recordDate)," ")}}function $e(i,e){i&1&&(a(0,"th",18),o(1," Actions "),r())}function je(i,e){if(i&1){let t=C();a(0,"td",19)(1,"button",20),g("click",function(){let c=b(t).$implicit,m=p(2);return _(m.deleteRecord(c.id))}),a(2,"mat-icon"),o(3,"delete"),r()()()}}function Qe(i,e){i&1&&u(0,"tr",21)}function Ye(i,e){i&1&&u(0,"tr",22)}function ze(i,e){if(i&1&&(a(0,"tr",23)(1,"td",24),o(2),r()()),i&2){p();let t=z(4);s(2),w('No data matching the date "',t.value,'"')}}function Ge(i,e){if(i&1){let t=C();a(0,"mat-form-field",4)(1,"mat-label"),o(2,"Date filter"),r(),a(3,"input",5,0),g("keyup",function(c){b(t);let m=p();return _(m.applyFilter(c))}),r()(),a(5,"div",6)(6,"table",7),I(7,8),f(8,Pe,2,0,"th",9)(9,Ne,2,1,"td",10),S(),I(10,11),f(11,Oe,2,0,"th",9)(12,Le,2,1,"td",10),S(),I(13,12),f(14,qe,2,0,"th",9)(15,He,3,3,"td",10),S(),I(16,13),f(17,$e,2,0,"th",9)(18,je,4,0,"td",10),S(),f(19,Qe,1,0,"tr",14)(20,Ye,1,0,"tr",15)(21,ze,3,1,"tr",16),r(),u(22,"mat-paginator",17),r()}if(i&2){let t=p();s(6),d("dataSource",t.dataSource),s(13),d("matHeaderRowDef",t.columns),s(),d("matRowDefColumns",t.columns),s(2),d("pageSizeOptions",W(4,Ve))}}var N=class i{userId=x.required();exerciseId=x.required();chartView=j(!1);columns=["weightLifted","repetitionsMade","recordDate","actions"];data;records=[];options;platformId=l(Q);trainingRecordService=l(h);dataSource=new P;paginator=L.required(V);sort=L.required(k);cd=l(X);ngOnInit(){this.trainingRecordService.getTrainingRecordsByUserIdAndExerciseId(this.userId(),this.exerciseId()).subscribe({next:e=>{this.records=e,this.dataSource=new P(e),this.initChart()}})}ngAfterViewInit(){this.trainingRecordService.getTrainingRecordsByUserIdAndExerciseId(this.userId(),this.exerciseId()).subscribe({next:e=>{this.records=e,this.dataSource=new P(e),this.initChart(),this.dataSource.sort=this.sort(),this.dataSource.paginator=this.paginator()}})}applyFilter(e){let t=e.target.value;this.dataSource.filterPredicate=(n,c)=>n.recordDate.trim().toLowerCase().includes(c),this.dataSource.filter=t.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}refreshRecords(){this.trainingRecordService.getTrainingRecordsByUserIdAndExerciseId(this.userId(),this.exerciseId()).subscribe({next:e=>{this.records=e,this.initChart(),this.dataSource.data=e,this.dataSource.sort=this.sort(),this.dataSource.paginator=this.paginator()}})}deleteRecord(e){this.trainingRecordService.deleteRecordById(e).subscribe({next:t=>{this.trainingRecordService.getTrainingRecordsByUserIdAndExerciseId(this.userId(),this.exerciseId()).subscribe({next:n=>{this.records=n,this.initChart(),this.dataSource.data=n,this.dataSource.sort=this.sort(),this.dataSource.paginator=this.paginator()}})}})}initChart(){if(ee(this.platformId)){let e=getComputedStyle(document.documentElement),t="white",n="white",c="white";this.data={labels:this.records.map(m=>m.recordDate),datasets:[{label:"repetitions",fill:!1,borderColor:e.getPropertyValue("--p-cyan-500"),yAxisID:"y",tension:0,data:this.records.map(m=>m.repetitionsMade)},{label:"weight",fill:!1,borderColor:e.getPropertyValue("--p-gray-500"),yAxisID:"y",tension:0,data:this.records.map(m=>m.weightLifted)}]},this.options={stacked:!1,maintainAspectRatio:!1,aspectRatio:.6,plugins:{legend:{labels:{color:t}}},scales:{x:{ticks:{color:n},grid:{color:c}},y:{type:"linear",display:!0,position:"left",ticks:{color:n},grid:{color:c}}}},this.cd.markForCheck()}}loadTableView(){this.trainingRecordService.getTrainingRecordsByUserIdAndExerciseId(this.userId(),this.exerciseId()).subscribe({next:e=>{this.records=e,this.initChart(),this.dataSource.data=e,this.chartView.set(!this.chartView()),this.refreshRecords()}})}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=T({type:i,selectors:[["app-user-training-records-tab"]],viewQuery:function(t,n){t&1&&(q(n.paginator,V,5),q(n.sort,k,5)),t&2&&Y(2)},inputs:{userId:[1,"userId"],exerciseId:[1,"exerciseId"]},decls:7,vars:1,consts:[["input",""],[1,"record-tab-content"],["mat-raised-button","",3,"click"],["type","line",1,"h-[30rem]",3,"data","options"],["appearance","outline"],["matInput","","placeholder","YYYY-MM-DD",3,"keyup"],[1,"mat-elevation-z8"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","weightLifted"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","repetitionsMade"],["matColumnDef","recordDate"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],[3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-icon-button","",3,"click"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(t,n){t&1&&(a(0,"div",1)(1,"button",2),g("click",function(){return n.refreshRecords()}),o(2,"Reload"),r(),a(3,"button",2),g("click",function(){return n.loadTableView()}),o(4,"Change View"),r(),f(5,ke,1,2,"p-chart",3)(6,Ge,23,5),r()),t&2&&(s(5),y(n.chartView()?5:6))},dependencies:[_e,D,A,F,B,k,Te,Se,we,ve,De,Ie,Me,Ee,Ue,Ae,V,Z,xe,ye,ne,Ce],styles:[".record-tab-content[_ngcontent-%COMP%]{padding:1rem 0}"]})};function We(i,e){if(i&1){let t=C();a(0,"mat-option",5),g("onSelectionChange",function(){let c=b(t).$implicit,m=p();return _(m.setExercise(c))}),o(1),r()}if(i&2){let t=e.$implicit;d("value",t.exerciseName),s(),G(t.exerciseName)}}var O=class i{dialogRef=l(ae);data=l(oe);trainingRecordService=l(h);exercisesBasicData=[];addRecordForm=new me({repetitions:new v(1,[R.required,R.min(1)]),weight:new v(0,[R.required,R.min(0)]),exerciseId:new v(1,[R.required]),exerciseName:new v("",[R.required])});setExercise(e){this.addRecordForm.controls.exerciseId.setValue(e.id)}ngOnInit(){this.trainingRecordService.getExercisesBasicData().subscribe({next:e=>{this.exercisesBasicData=e}})}createRecord(){this.addRecordForm.value.weight!==void 0&&this.addRecordForm.value.weight!==null&&this.addRecordForm.value.exerciseId!==void 0&&this.addRecordForm.value.exerciseId!==null&&this.addRecordForm.value.repetitions!==void 0&&this.addRecordForm.value.repetitions!==null&&this.trainingRecordService.createTrainingRecord({recordDate:new Date().toISOString().split("T")[0],exerciseId:this.addRecordForm.value.exerciseId,userId:this.data.userId,repetitionsMade:this.addRecordForm.value.repetitions,weightLifted:this.addRecordForm.value.weight}).subscribe({next:e=>{this.dialogRef.close()}})}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=T({type:i,selectors:[["app-add-record-dialog"]],decls:17,vars:3,consts:[["appearance","outline"],["type","number","matInput","","min","0",3,"formControl"],[3,"formControl"],[3,"value"],["mat-flat-button","",3,"click"],[3,"onSelectionChange","value"]],template:function(t,n){t&1&&(a(0,"mat-dialog-content")(1,"mat-form-field",0)(2,"mat-label"),o(3,"Repetitions"),r(),u(4,"input",1),r(),a(5,"mat-form-field",0)(6,"mat-label"),o(7,"Weight"),r(),u(8,"input",1),r(),a(9,"mat-form-field",0)(10,"mat-label"),o(11,"Exercise"),r(),a(12,"mat-select",2),E(13,We,2,2,"mat-option",3,M),r()(),a(15,"button",4),g("click",function(){return n.createRecord()}),o(16,"Add"),r()()),t&2&&(s(4),d("formControl",n.addRecordForm.controls.repetitions),s(4),d("formControl",n.addRecordForm.controls.weight),s(4),d("formControl",n.addRecordForm.controls.exerciseName),s(),U(n.exercisesBasicData))},dependencies:[ce,A,B,F,fe,de,pe,le,ge,ue,re,D,Re],encapsulation:2})};function Je(i,e){if(i&1){let t=C();a(0,"button",2),g("click",function(){b(t);let c=p();return _(c.openAddRecordDialog({userId:c.userId()}))}),o(1,"New Record"),r()}}function Ke(i,e){if(i&1&&(a(0,"mat-tab",1),u(1,"app-user-training-records-tab",3),r()),i&2){let t=e.$implicit,n=p();d("label",t.exerciseName),s(),d("userId",n.userId())("exerciseId",t.id)}}var Fe=class i{trainingRecordService=l(h);userId=x.required();editable=x.required();exerciseBasicData=[];dialog=l(se);ngOnInit(){this.trainingRecordService.getTrainingRecordExercisesBasicDataByUserId(this.userId()).subscribe({next:e=>{this.exerciseBasicData=e}})}openAddRecordDialog(e){this.dialog.open(O,{data:e}).afterClosed().subscribe({next:()=>{this.trainingRecordService.getTrainingRecordExercisesBasicDataByUserId(this.userId()).subscribe({next:t=>{this.exerciseBasicData=t}})}})}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=T({type:i,selectors:[["app-user-training-recods-panel"]],inputs:{userId:[1,"userId"],editable:[1,"editable"]},decls:4,vars:1,consts:[["mat-flat-button",""],[3,"label"],["mat-flat-button","",3,"click"],[3,"userId","exerciseId"]],template:function(t,n){t&1&&(f(0,Je,2,0,"button",0),a(1,"mat-tab-group"),E(2,Ke,2,3,"mat-tab",1,M),r()),t&2&&(y(n.editable()?0:-1),s(2),U(n.exerciseBasicData))},dependencies:[be,he,N,D],encapsulation:2})};export{Fe as UserTrainingRecordsPanelComponent};
